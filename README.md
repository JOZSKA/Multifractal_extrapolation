# Multifractals
This code can be used for two purposes: 1. (universal) multifractal analysis of a 2D data-set, 2. (stochastic) downscaling of the data-set to smaller scales. All the essential universal multifractal properties for 2D distributions are provided in the multifractal class (module multifractal_class_pub). The downscaling is provided by the core field extrapolation function (module field_extrapolation_pub). 
#
General purpose: At various ranges of scales one can frequently demonstrate that physical, biological (or other) variables have a stochastic symmetry of scale-invariance. Moreover, it can be frequently argued that the symmetry of scale-invariance is a continuous symmetry. Mathematically this (together with stability) implies that the stochastic model (consequently the PDF for the variables) can be parametrized by only three scaling parameters (universal multifractals). This surprisingly simple structure behind the complex looking distributions is analysed and used by this code. 
#
To find the multifractal properties of a distribution 'rho', all you need is to plug 'rho' into the 'multifractals' class. Then you just extract the multifractal attributes of your interest (i.e rho.fluxes, rho.increments_scaling , rho.UM_parameters ...). (Note that the 'UM parameters' attribute provides one with three scaling parameters (H, alpha, C1) and furthermore with the scale of flux homogeneity (the outer scale of the process), the proportionality constant for the fluctuations scaling and the relative error of the UM fit. (All in the given order.) The analysis uses default settings from the multifractal_parameter_values_pub module, which can be changed as suits the user. 
#
One can then use the scale-invariance of the distribution and assuming that it extends to some smaller scales, one can use the scale-invariant PDF to statistically extrapolate the distribution values to smaller scales. This is a  handy tool how to improve model resolution (in a stochastic sense), or add some important piece of information about distribution properties (/values) at lower scales.  To stochastically re-distribute the distribution at lower scales, one plugs the distribution 'rho' into the 'field_extrapoaltion function' together with the value for the 'number of iterations'. The 'number of iterations' parameter identifies the extrapolation scale to which the distribution is downscaled as: 'extrapolation scale' = 'scale of original data resolution' / 2**(number of iterations). Therefore the following values of numbers of iterations = 1,2,3,4 lead to dowscaling by the factors = 2,4,8,16 ... . After providing the large-scale-distribution and identifying the scale of extrapolation, the algorithm goes as follows: 1. It identifies the fluxes & UM parameters and derives the PDF for the UM fluxes using inverse Mellin transform. 2. The algorithm then uses the PDF and randomly redistributes the fluxes at the extrapolation scale. 3. The algorithm further smoothens the field distribution at the extrapolation scale. This smoothened distribution is later used as a guide, as to whether the fluctuations are distributed with positive or negative value. 4. It derives the fluctuation sizes from the fluxes and using an algorithm that randomly connects neighbouring pixels (creating random connected networks) one distributes the field values at the lower scale to obtain: a) the correct fluctuation sizes, b) whether the fluctuation corresponds to a distribution increase, or decrease, is determined by the values of the smoothened field. This means one obtains the 'natural' smoothened field distribution at the lower scale with the correct 'bumps' derived from the universal multifractal model.
#
Author: Jozef Skakala, PML, 2016.
